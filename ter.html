<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		
		<title>.ter Format</title>
		

		<meta name="description" content="">
		<meta name="keywords" content="programming, code">

		<link rel="shortcut icon" type="image/png" href="../images/personal_logo_small.png"/>
		<link rel="stylesheet" href="../css/subpage-style.css" type="text/css" />
	</head>
	<body class="page-fileformats">

		<div class="container padded">
			<h1 class="page-title">.ter Format</h1>
		</div>

		<div class="container">

			
				<aside class="menu">
	<ul class="navigation blocks">
		
		
		
			<li class="category"><span class="category-title">Navigation</span></li>
			
			<li class="link"><a href="#overview">Overview</a></li>
			
			<li class="link"><a href="index.html">Back</a></li>
			
		
			<li class="category"><span class="category-title">Format</span></li>
			
			<li class="link"><a href="terrain-header">Terrain Header</a></li>
			
			<li class="link"><a href="terrain-header">Terrain Blocks</a></li>
			
			<li class="link"><a href="terrain-structs">Terrain Structs</a></li>
			
		
		
		
	</ul>
</aside>
			

			
			<div class="content">
				
				

				
						
							<section class="block">

<h2 id="overview">Overview</h2>

<p>Terrain files (*.ter) represent a single terrain to be used by a world.
This file format is generated by ZeroEditor and used during the munge process
to create the <em>tern</em> chunk within *.lvl files.</p>

</section>
						
							<section class="block">

<h2 id="structure">Structure</h2>

<table>
<thead>
<tr>
<th>Name</th>
<th>Size (bytes)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Terrain Header</td>
<td>2820/2821 (v21/22)</td>
<td>Header storing general information about the terrain.</td>
</tr>
<tr>
<td>Height Block</td>
<td><strong>size * size</strong> * 2</td>
<td>Height grid data.</td>
</tr>
<tr>
<td>Color Block</td>
<td><strong>size * size</strong> * 4</td>
<td>RGBA colors for the terrain grid.</td>
</tr>
<tr>
<td>Color Block</td>
<td><strong>size * size</strong> * 4</td>
<td>RGBA colors for the terrain grid.</td>
</tr>
<tr>
<td>Texture Block</td>
<td><strong>size * size</strong> * 16</td>
<td>Texture layer opacity for the terrain grid.</td>
</tr>
<tr>
<td>?</td>
<td><strong>size * size</strong> / 2</td>
<td>Maybe Water/Foliage.</td>
</tr>
<tr>
<td>?</td>
<td><strong>size * size</strong> / 2</td>
<td>Probably Water.</td>
</tr>
<tr>
<td>?</td>
<td>Variable</td>
<td>Not sure what this contains but it seems that this block is not required.</td>
</tr>
</tbody>
</table>

</section>
						
							<section class="block">

<h2 id="terrain-header">Terrain Header</h2>

<p>The Terrain Header is always 2821 bytes in length.</p>
<table>
<thead>
<tr>
<th>Data Type</th>
<th>Size (bytes)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>byte [4]</code></td>
<td>4</td>
<td>Terrain Header Marker (TERR).</td>
</tr>
<tr>
<td><code>long int</code></td>
<td>4</td>
<td>.TER file version number (21 for SWBF, 22 for SWBFII).</td>
</tr>
<tr>
<td><code>short int [4]</code></td>
<td>8</td>
<td>Terrain extents. <em>Example: -8, -8, 8, 8 for a 16x16 map.</em></td>
</tr>
<tr>
<td><code>long int</code></td>
<td>4</td>
<td>? (ie. 164)</td>
</tr>
<tr>
<td><code>float [16]</code></td>
<td>64</td>
<td>Tile-range for each texture layer. _0.031 (1/32): the texture spans 32 meters. This is stored as 1/X of the value in ZeroEditor.</td>
</tr>
<tr>
<td><code>byte [16]</code></td>
<td>16</td>
<td>Mapping for each texture-layer. 0 is normal.</td>
</tr>
<tr>
<td><code>byte [64]</code></td>
<td>64</td>
<td>Unknown. Possibly 16 floats for texture-layer rotations.</td>
</tr>
<tr>
<td><code>float</code></td>
<td>4</td>
<td>Map height multiplier.</td>
</tr>
<tr>
<td><code>float</code></td>
<td>4</td>
<td>Grid-scale. Distance between points.</td>
</tr>
<tr>
<td><code>long int</code></td>
<td>4</td>
<td>? (1)</td>
</tr>
<tr>
<td><code>long int</code></td>
<td>4</td>
<td>Full map size stored in the .TER file. The same or bigger than the map extents.</td>
</tr>
<tr>
<td><code>long int</code></td>
<td>4</td>
<td>? (2)</td>
</tr>
<tr>
<td><code>byte</code></td>
<td>1</td>
<td>? (0F) Only exists in SWBF II (version 22) terrain.</td>
</tr>
<tr>
<td><code>TextureLayer [16]</code></td>
<td>1024</td>
<td>Texture layers (see below).</td>
</tr>
<tr>
<td><code>WaterLayer [16]</code></td>
<td>1086</td>
<td>Water layers (see below).</td>
</tr>
<tr>
<td><code>byte [524]</code></td>
<td>524</td>
<td>Unknown.</td>
</tr>
</tbody>
</table>

</section>
						
							<section class="block">

<h2 id="terrain-blocks">Terrain Blocks</h2>

<p>The Terrain Header is 2820 (SWBF) or 2821 (SWBFII) bytes in length.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Height</strong></td>
<td><code>signed short</code></td>
<td><strong>Full map size * Full map size</strong> * 2</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Height value for every point on the grid. This value will be multiplied with the map scale multiplier.</td>
</tr>
<tr>
<td><strong>Color</strong></td>
<td><code>byte [4]</code></td>
<td><strong>Full map size * Full map size</strong> * 4</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Color values for every point on the grid. 4 bytes (from 0 to 255) corresponding to the RGBA channels.</td>
</tr>
<tr>
<td><strong>Color 2</strong></td>
<td><code>byte [4]</code></td>
<td><strong>Full map size * Full map size</strong> * 4</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Color values for every point on the grid. 4 bytes (from 0 to 255) corresponding to the RGBA channels.</td>
</tr>
<tr>
<td><strong>Texture</strong></td>
<td><code>byte [16]</code></td>
<td><strong>Full map size * Full map size</strong> * 16</td>
</tr>
<tr>
<td></td>
<td></td>
<td>One byte (0-255) for each texture layer indicating the transparency of the corresponding texture layer.</td>
</tr>
<tr>
<td><strong>Water</strong></td>
<td><code>byte</code></td>
<td><strong>Full map size * Full map size</strong> / 2</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Structure unknown.</td>
</tr>
<tr>
<td><strong>Foliage</strong></td>
<td><code>byte</code></td>
<td><strong>Full map size * Full map size</strong> / 2</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Structure unknown.</td>
</tr>
<tr>
<td><strong>Unknwon</strong></td>
<td><code>byte</code></td>
<td>Variable</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Structure unknown.</td>
</tr>
</tbody>
</table>

</section>
						
							<section class="block">

<h2 id="terrain-structs">Terrain Structs</h2>

<h3>TextureLayer</h3>
<table>
<thead>
<tr>
<th>Data Type</th>
<th>Size (bytes)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>char [32]</code></td>
<td>32</td>
<td>Diffuse texture name.</td>
</tr>
<tr>
<td><code>char [32]</code></td>
<td>32</td>
<td>Detail texture name.</td>
</tr>
</tbody>
</table>
<h3>WaterLayer</h3>
<table>
<thead>
<tr>
<th>Data Type</th>
<th>Size (bytes)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float [2]</code></td>
<td>8</td>
<td>Water height value (twice).</td>
</tr>
<tr>
<td><code>byte [8]</code></td>
<td>8</td>
<td>Unknown, always zero.</td>
</tr>
<tr>
<td><code>float [2]</code></td>
<td>8</td>
<td>UV animation velocity.</td>
</tr>
<tr>
<td><code>float [2]</code></td>
<td>8</td>
<td>UV animation repeat.</td>
</tr>
<tr>
<td><code>byte [4]</code></td>
<td>4</td>
<td>RGBA color values.</td>
</tr>
<tr>
<td><code>char [32]</code></td>
<td>32</td>
<td>Water texture name.</td>
</tr>
</tbody>
</table>
<h3>End-of-file Block</h3>
<p>Can be empty</p>
<table>
<thead>
<tr>
<th>Data Type</th>
<th>Size (bytes)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>int</code></td>
<td>4</td>
<td>Length of the block.</td>
</tr>
<tr>
<td><code>int</code></td>
<td>4</td>
<td>Number of items. Can be zero, in which case there are no further fields and this block ends.</td>
</tr>
<tr>
<td><code>int</code></td>
<td>4</td>
<td>Number of (sub-)items?</td>
</tr>
</tbody>
</table>

</section>
						
				
			</div>
			

			
				<footer>
</footer>
			

		</div>

	</body>
</html>